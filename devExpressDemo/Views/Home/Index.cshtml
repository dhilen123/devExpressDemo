@using DevExpress.ClipboardSource.SpreadsheetML
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_DevExtremeLayout.cshtml";
}


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        window.jsPDF = window.jspdf.jsPDF;
    </script>



<h2 class="text-white text-center">Employee List</h2>
@(
Html.DevExtreme().DataGrid<devExpressDemo.Models.Product>()
    .ID("gridContainer")
    .DataSource(ds => ds.Mvc()
        .Controller("Home")
        .LoadAction("GetProducts")
        .InsertAction("Post")
        .UpdateAction("Put")
        .DeleteAction("Delete")
        .Key("Id")
    )
    .Selection(s => s.Mode(SelectionMode.Multiple))
    .Export(e => e.Enabled(true)
        .AllowExportSelectedData(true)
        .Formats(new[] { "pdf" })
    )
    .OnExporting("exportToPDF")
    .ColumnChooser(c => c.Enabled(true))
    .RemoteOperations(true)
    .ShowBorders(true)
    .AllowColumnReordering(true)
    .AllowColumnResizing(true)
    .HoverStateEnabled(true)
    .Paging(paging => paging.PageSize(10))
    .Pager(pager =>
    {
        pager.Visible(true);
        pager.DisplayMode(GridPagerDisplayMode.Full);
        pager.ShowPageSizeSelector(true);
        pager.AllowedPageSizes(new JS("[5, 10, 'all']"));
        pager.ShowInfo(true);
        pager.ShowNavigationButtons(true);
    })
    .SearchPanel(s => s
        .Visible(true)
        .HighlightCaseSensitive(true)
    )
    .Columns(columns =>
    {
        columns.AddFor(m => m.Id).Caption("ID").AllowSorting(true).CssClass("text-center").Fixed(true);
        columns.AddFor(m => m.Name).Caption("Name").AllowSorting(true).CssClass("text-center");
        columns.AddFor(m => m.Email).Caption("Email").AllowSorting(true).CssClass("text-center");
        columns.AddFor(m => m.Price).Caption("Price").AllowSorting(true).CssClass("text-center");
        columns.Add().Caption("Image").AllowSorting(false).CellTemplate(@<text>
            <img src="<%- data.Image %>" alt="Image" style="width:50px; height:auto;" />
        </text>);
    })
    .Summary(s => s.TotalItems(item =>
    {
        item.AddFor(m => m.Price).SummaryType(SummaryType.Sum).ValueFormat(Format.Currency);
    }))
    .Editing(e => e
        .AllowAdding(true)
        .AllowUpdating(true)
        .AllowDeleting(true)
    )
)



<script type="text/javascript">
    function exportToPDF(e) {
        var doc = new jsPDF();

        DevExpress.pdfExporter.exportDataGrid({
            jsPDFDocument: doc,
            component: e.component,
            indent: 5,
        }).then(function () {
            doc.save("Companies.pdf");
        });
    }
</script>